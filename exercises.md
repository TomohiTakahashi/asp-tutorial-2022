**注意: 「実装せよ」など特に明記されている場合を除いて，適当なライブラリを使用して構いません．**

推奨ライブラリは下記の通りです．また，下記ライブラリの使用を前提とした問題も一部出題されます．

- 行列・ベクトル計算: [numpy](https://numpy.org)
- 可視化: [matplotlib](https://matplotlib.org)
- 音声ファイル操作: [soundfile](https://pysoundfile.readthedocs.io/en/latest/)

# 第 1 章: 基礎

1. 振幅 1, 周波数 440 Hz の正弦波をサンプリング周波数 16000 Hz で 3 秒分作成しプロットせよ．
2. 1.で作成した正弦波を 16bit PCM フォーマットで wav ファイルとして保存せよ．
3. 振幅 1, 周波数 660 Hz の正弦波をサンプリング周波数 16000 Hz で 3 秒分作成し，1.で作成した信号と合わせて 2ch の wav ファイルとして保存せよ．
4. ホワイトノイズをサンプリング周波数 16000 Hz で 3 秒分作成しプロットせよ．
5. 1.で作成した正弦波と 4.で作成したホワイトノイズと正弦波を混合してプロットせよ．
6. 信号長の等しい 2 個の信号 $s[n], x[n]\; (n = 0, \dots, N-1), $ の信号対雑音比 (SN比) $10 \log \frac{\sum _{n=0} ^{N-1} s[n] ^2}{\sum _{n=0} ^{N-1} x[n] ^2}$ を計算する関数を実装せよ．
7. SN 比を任意の値に設定できるようにホワイトノイズの振幅を調整する関数を実装せよ．元信号と所望の SN 比を入力として受け取り，ホワイトノイズを重畳した信号を出力すること．
8. 8.で実装した関数を用いて，6.と同様にホワイトノイズと正弦波の混合信号を作成し wav ファイルとして保存せよ．ただし，SN 比が 6dB となるようにすること．
9. 8.で保存した wav ファイルを読み込み，サンプリング周波数を 8kHz に変換して保存せよ．
10. 9.の信号に対して 5 点移動平均フィルタを適用した結果と元の信号をプロットせよ．

# 第 2 章: スペクトル解析

1. $N$ 点の信号 $x[n] \, (n = 0, \dots , N-1)$ の離散フーリエ変換 (DFT) $$X[k] = \sum _{n=0} ^{N-1} x[n] \exp \left( -j \frac{2\pi k n}{N} \right) \, (k = 0, \dots, N-1)$$ とその逆変換(IDFT)$$x[n] = \frac{1}{N} \sum _{k=0} ^{N-1} X[k] \exp \left( j \frac{2\pi k n}{N} \right) \, (n = 0, \dots, N-1)$$を計算する関数を実装せよ．
2. 1.で実装した関数を用いて 8 点の単位インパルス信号 $\delta [n] = [1, 0, 0, 0, 0, 0, 0, 0]$ の DFT を計算せよ．
3. 2.の結果の IDFT を計算しプロットせよ．
4. 2.の結果の振幅スペクトルおよび位相スペクトル $|X[k]|, \angle X[k] \, (k = 0, \dots, N-1)$ をプロットせよ．
5. 8 点の単位インパルス信号の DFT を `numpy.fft.fft` 関数を用いて計算し，2.の結果と比較せよ．なお，これ以降 DFT を計算する場合は `numpy.fft.fft`関数を使用してよい．
6. 第 1 章 1.で作成した信号の DFT を計算し，振幅スペクトルと位相スペクトルをプロットせよ．（プロットする際はデシベル表記にするために `20 * log10(np.abs(X))` などのようにしてデシベル表記になおしてから計算すると見やすいです．）
7. 次式で定義される $N$点の Hamming 窓を作成する関数を実装せよ． $$w[n] = 0.54 - 0.46 \cos (2\pi \frac{n}{N - 1}) \, (n = 0, \dots, N-1)$$
8. 第 1 章 1.で作成した信号に対して 6.の窓関数を適用した信号をプロットせよ．
9. 第 1 章 1.で作成した信号と同じ長さの Hamming 窓を作成し，DFT を計算せよ．
10. 第 1 章 1.で作成した信号の DFT を $X[k] (k = 0, \dots, N-1)$，9.の結果を $Y[k] (k = 0, \dots, N-1)$ とする． $X[k]$ と $Y[k]$ の巡回畳み込み $Z[k] = \sum _{n=0} ^{N-1} X[n] Y[k-n] (k = 0, \dots, N-1)$ の IDFT を計算し 8.の結果と比較せよ．

# 第 3 章: 畳み込みと簡単なフィルタ処理

1. $N$ 点の信号 $x[n], h[n] (n = 0, \dots, N-1)$ の線形畳み込み $z[n] = \sum _{k = 0} ^{N-1} x[k] h[n - k], (n = 0, \dots, 2N - 2)$ を計算する関数を実装せよ．ただし， $n - k < 0$ または $n - k > N-1$ では信号の値は 0 とすること．
2. $N$ 点の信号 $x[n], h[n] (n = 0, \dots, N-1)$ の巡回畳み込み $z[n] = \sum _{k = 0} ^{N-1} x[k] h[(n - k) \mod N], (n = 0, \dots, N-1)$ を計算する関数を実装せよ．ただし， $a \mod b$ は $a$ を $b$ で割った余りを表す．
3. $N$ 点の信号 $x[n], y[n]$ に適切な零詰めを行って巡回畳み込みを計算することで，線形畳み込みと同じ結果を与える関数を実装せよ．
4. 1., 2., 3. で実装した関数を用いて $x[n] = [4, 3, 2, 1]$ と $y[n] = [1, 0, -1, 0]$ の線形畳み込み，巡回畳み込み，零詰めを行った巡回畳み込みを計算し結果をプロットせよ．
5. 次の差分方程式 $y[n] = 0.2 x[n] + 0.2 x[n-1] + 0.2 x[n-2] + 0.2 x[n-3] + 0.2 x[n-4]$ で表される信号 $y[n]$ をプロットせよ． ただし， $x[n]$ は単位インパルス信号として 10 点プロットせよ．
6. 次の差分方程式 $y[n] = 0.3 y[n-1] + 0.4 x[n]$ で表される信号 $y[n]$ をプロットせよ． ただし， $x[n]$ は単位インパルス信号として 10 点プロットせよ．
7. 一般の差分方程式 $a_0 y[n] = - \sum _{k = 1} ^{N} a_k y[n-k] + \sum _{k = 0} ^{M} b_k x[n - k]$ で表される信号を計算する関数を実装せよ．ただし，入力は $a_0, \dots, a_N (a_0 \neq 0)$ の配列， $b_0, \dots, b_M$ の配列，および入力信号 $x[n] (n = 1, \dots, L)$ とすること．
8. 次の差分方程式 $y[n] = - \sum _{k = 1} ^{N} a_k y[n-k] + \sum _{k = 0} ^{M} b_k x[n - k]$ で表される信号の周波数応答 $H(e^{j\omega}) = \frac{\sum _{k=0} ^M b_k e^{-j\omega k}}{1 + \sum _{k=1} ^{N} a_k e^{-j\omega k}}$ を計算する関数を実装せよ．ただし， $\omega$ はサンプリング周波数を $f_s$ としたときの正規化各周波数 $\omega = \frac{2 \pi f}{f_s} (0 \leq f \lt f_s)$ である．
9. 8.で実装した関数を用いて，5.の信号の周波数応答 $H(e^{j\omega})$ を計算し，振幅特性 $|H(e^{j\omega})|$ および位相特性 $\angle H(e^{j\omega})$ をプロットせよ．ただし，サンプリング周波数 $f_s = 16000$ とし，$f = 0, \frac{1}{N} f_s, \dots, \frac{N-1}{N} f_s$ まで計算せよ（$N$ は適当に決めてよい）．
10. 8.で実装した関数を用いて，6.の信号の周波数応答 $H(e^{j\omega})$ を計算し，振幅特性 $|H(e^{j\omega})|$ および位相特性 $\angle H(e^{j\omega})$ をプロットせよ．ただし，サンプリング周波数 $f_s = 16000$ とし，$f = 0, \frac{1}{N} f_s, \dots, \frac{N-1}{N} f_s$ まで計算せよ（$N$ は適当に決めてよい）．

# 第 4 章: 短時間フーリエ変換

1. **零詰め**: 窓幅 $L$ ，シフト幅 $S (\lt L)$，および $N$ 点の実数値信号 $x[n]$ $(n = 0, \dots, N-1)$ を入力とし，下記の手順で零詰めした信号を出力する関数を実装せよ．
   1. 入力の先頭および末尾に $L - S$ 個の零詰め: $[\underbrace{0, \dots, 0}_{L - S}, x[0], \dots, x[N-1], \underbrace{0, \dots, 0}_{L - S}]$
   2. 最終的な信号の長さが $S$ の倍数となるよう入力の末尾に零詰め
2. **フレーム分割**: 窓幅 $L$ ，シフト幅 $S (\lt L)$，および $N$ 点の実数値信号 $x[n]$ $(n = 0, \dots, N-1)$ を入力とし，1.で実装した関数を用いて $L$ 点の信号（以下，フレームと呼ぶ）の列を出力する関数を実装せよ．
   1. $t$ $(t = 0, \dots, T-1)$ 番目のフレームを次で求める: $x_t [l] \coloneqq \tilde{x}[tS+l]$ $(l = 0, \dots, L-1)$, ただし， $\tilde{x}[n]$ は零詰め後の入力
3. **STFT の実装**: 窓幅 $L$ ，シフト幅 $S (\lt L)$，窓関数 $w[l] (l = 0, \dots, L-1)$ ，および $N$ 点の実数値信号 $x[n]$ $(n = 0, \dots, N-1)$ を入力とし，下記の手順で $x[n]$ の短時間フーリエ変換を出力する関数を実装せよ．このとき，出力は $(\frac{L}{2}+1) \times T$ の複素数行列となることに注意せよ．
   1. 2.で実装した関数を用いて，各フレームに対して窓関数 $w[l] (l = 0, \dots, L-1)$ をかけ `np.fft.rfft` 関数を適用する．
4. **STFT の確認**: 振幅 1, 周波数 440 Hz の正弦波をサンプリング周波数 16000 Hz で 0.1 秒分作成し，2.で実装した関数を用いてスペクトログラムを計算せよ．ただし，窓幅を 1000，窓関数を Hamming 窓，シフト幅を 500 とすること．さらに，振幅スペクトログラム・位相スペクトログラムをプロットせよ．プロットには `matplotlib.pyplot.pcolormesh` を使用すること．
5. **合成窓**: シフト幅 $S$ と $L$ 点の窓関数 $w[l] (l = 0, \dots, L-1)$ を入力とし，次の結果を出力する関数を実装せよ．なお，これは逆短時間フーリエ変換に用いる最適合成窓のひとつである．
   1. $Q \gets \frac{L}{S}$
   2. $w_\mathrm{s}[l] = \frac{w[l]}{\sum _{k = -(Q - 1)} ^{Q - 1} (w[l - m S]) ^ 2}$
6. **ISTFT の実装**: シフト幅 $S$ および $F\times T$ の複素数行列 $X[f, t]$ $(f = 0, \dots, F-1, t = 0, \dots, T-1)$ を入力とし，下記の手順で $M$ 点の信号 $\hat{x}[n]$ を出力する関数を実装せよ．
   1. 窓幅 $N$ を計算および出力信号の長さ $M$ を計算: $N \gets 2 (F - 1)$, $M \gets S (T - 1) + N$
   2. 出力信号を初期化: $\hat{x}[m] = 0 \quad \forall m$
   3. 各フレーム $t$ について逆 DFT を計算: $z_t[n] \gets \mathcal{F}^{-1}(X[t, 0], \dots, X[t, F-1])$ $(n = 0, \dots, N-1)$
      ただし， $\mathcal{F}^{-1}$ は逆 DFT を表す．逆 DFT には `np.fft.irfft` 関数を使用すること．これにより， $z[n]$ の点数は $N = 2(F-1)$ となることに注意せよ．
   4. Overlap add の計算: $\hat{x}[t S + n] = \hat{x}[t S + n] + w_\mathrm{s}[n] z_t[n]$
      ただし， $w_\mathrm{s}[n]$ は 5.で計算される最適合成窓， $z[n]$は上で計算した逆 DFT である．
7. **ISTFT の確認**: 6.で実装した関数を用いて，4.の結果の逆短時間フーリエ変換を計算し結果をプロットせよ．
8. **合成窓の確認**: 6.の実装において，合成窓をかけない場合の ISTFT を実装し，前問の結果と比較せよ．
9. **不確定性原理の確認**: 振幅 1, 周波数 440 Hz の正弦波をサンプリング周波数 16000 Hz で 1 秒分作成し，窓幅を 100, 200, 400, 800 と変えながらスペクトログラムをプロットし結果を比較せよ．
10. **時間周波数のインデクスと物理量との対応**: サンプリング周波数，窓幅，シフト幅を入力とし，3.の実装で得られるスペクトログラムの縦軸，横軸を物理的な時間と周波数に変換する関数を実装し，4.の結果の縦軸を周波数，横軸を時間に変更したものをプロットせよ．

# 第 5 章: 線形代数基礎

準備中

1. ベクトルをプロットする
2. 固有値・固有ベクトルを計算する
3. 二次形式を可視化する
4. ガウス消去法を実装する
5. べき乗法を実装する

# 第 x 章: 最適化

準備中

# 第 x 章: 統計的信号処理

準備中

1. 相互相関
1. 自己相関
1. 主成分分析

# 第 x 章: アレイ信号処理基礎

準備中

# 第 x 章: ビームフォーミング

準備中

# 第 x 章: 独立成分分析

準備中

# 参考文献

- 飯國: 基礎から学ぶ信号処理, 培風館, 2004.
- 貴家: ディジタル信号処理のエッセンス, オーム社, 2014.
- 阿部, 八巻, 川又: Python 対応 ディジタル信号処理, 森北出版, 2021.
